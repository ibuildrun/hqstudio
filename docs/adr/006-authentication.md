# ADR-006: JWT аутентификация

**Дата**: 2024-02-10
**Статус**: Accepted

## Контекст

Необходимо было выбрать механизм аутентификации. Рассматривались:

1. **JWT (JSON Web Tokens)** — stateless токены
2. **Session-based** — серверные сессии
3. **OAuth 2.0 / OpenID Connect** — делегированная аутентификация
4. **API Keys** — простые ключи

Требования:
- Поддержка Web и Desktop клиентов
- Stateless для масштабирования
- Role-based access control (RBAC)

## Решение

Выбрана **JWT аутентификация** с BCrypt для хеширования паролей.

Реализация:
- JWT Bearer токены (24 часа)
- BCrypt для хеширования паролей
- Роли: Admin, Editor, Manager
- Отдельные права для Web и Desktop

## Последствия

### Положительные

- **Stateless**: не нужно хранить сессии на сервере
- **Масштабируемость**: любой сервер может валидировать токен
- **Кроссплатформенность**: работает с Web и Desktop
- **Самодостаточность**: токен содержит всю информацию о пользователе

### Отрицательные

- **Отзыв токена**: сложно отозвать до истечения срока
- **Размер**: JWT больше чем session ID
- **Безопасность**: при утечке токена — полный доступ до истечения

### Нейтральные

- Refresh токены планируются в будущем
- Токен хранится в localStorage (Web) и памяти (Desktop)

## Связанные решения

- [ADR-002](002-api-technology.md) — ASP.NET Core JWT Bearer
