# ADR-009: Стратегия тестирования

**Дата**: 2025-04-01
**Статус**: Accepted

## Контекст

Необходимо было определить стратегию тестирования для всех компонентов.

Типы тестов:
1. **Unit tests** — изолированные тесты функций
2. **Integration tests** — тесты взаимодействия компонентов
3. **E2E tests** — сквозные тесты пользовательских сценариев

## Решение

### API (HQStudio.API)
- **xUnit** — тестовый фреймворк
- **FluentAssertions** — читаемые assertions
- **WebApplicationFactory** — integration tests
- **Testcontainers** — PostgreSQL в Docker для тестов

### Web (HQStudio.Web)
- **Vitest** — тестовый фреймворк
- **@vitest/coverage-v8** — покрытие кода

### Desktop (HQStudio.Desktop)
- **xUnit** — тестовый фреймворк
- **FluentAssertions** — assertions
- Unit tests только (без UI тестов в CI)

### Покрытие
- **Codecov** — отслеживание покрытия
- Flags: `api`, `web`
- Target: ~50%

## Последствия

### Положительные

- **Быстрая обратная связь**: тесты в CI
- **Регрессии**: автоматическое обнаружение
- **Документация**: тесты как спецификация
- **Рефакторинг**: уверенность при изменениях

### Отрицательные

- **Время CI**: тесты увеличивают время сборки
- **Поддержка**: тесты нужно обновлять
- **Flaky tests**: нестабильные тесты в CI

### Нейтральные

- Desktop UI тесты пропускаются в CI (требуют Windows GUI)
- E2E тесты планируются в будущем

## Связанные решения

- [ADR-007](007-ci-cd-pipeline.md) — CI/CD пайплайн
